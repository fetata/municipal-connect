{% extends "base.html" %}

{% block content %}

<div class="d-flex justify-content-between align-items-center mb-3">

    <h2>Marketplace</h2>

    <form method="get" class="d-flex" style="gap: 10px;">
        <input type="text"
               name="q"
               value="{{ request.GET.q }}"
               placeholder="Search marketplace..."
               class="form-control"
               oninput="if(this.value === '') this.form.submit();">

        <button type="submit" class="btn btn-outline-primary">
            Search
        </button>
    </form>

    <a href="{% url 'marketplace:create' %}" class="btn btn-success">
        Create Item
    </a>

</div>



{% if items %}
    <div class="row">
        {% for item in items %}
            <div class="col-md-4 mb-3">
                <div class="card h-100">

                    {% if item.image %}
                        <img src="{{ item.image.url }}" class="card-img-top" style="height: 200px; object-fit: cover;">
                    {% endif %}

                    <div class="card-body">
                        <h5>
                            <a href="{% url 'marketplace:details' item.pk %}">
                                {{ item.title }}
                            </a>
                        </h5>
                        <p>{{ item.description|truncatechars:60 }}</p>

                        <p>
                            <span class="badge bg-primary">{{ item.type }}</span>
                            <span class="badge bg-secondary">{{ item.condition }}</span>
                        </p>

                        <p>
                            <strong>Category:</strong> {{ item.category.name }}
                        </p>
                    </div>

                </div>
            </div>
        {% endfor %}
    </div>
{% else %}
    <p>No items yet.</p>
{% endif %}

{% endblock %}
